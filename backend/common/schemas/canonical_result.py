from pydantic import BaseModel, Field
from typing import Any, List, Optional, Dict


class TrialRecord(BaseModel):
    nct_id: str
    phase: str
    status: str
    condition: str
    region: Optional[str] = None
    results_summary: Optional[str] = None

class CanonicalResult(BaseModel):
    molecule: str
    trial_summary: Optional[str] = None
    trials: List[TrialRecord] = Field(default_factory=list)
    key_findings: List[str] = Field(default_factory=list)
    suggested_follow_up: List[str] = Field(default_factory=list)
    data_completeness_score: Optional[float] = None
    confidence_overall: Optional[float] = None
    
    # New Fields
    swot_analysis: Optional[Dict[str, List[str]]] = None
    risk_assessment: Optional[str] = None
    market_data: Optional[Dict[str, Any]] = None
    
    synthesis_version: str = "0.2.0"

class SynthesisOutput(BaseModel):
    # The pure analysis part generated by LLM
    trial_summary: str
    key_findings: List[str]
    suggested_follow_up: List[str]
    data_completeness_score: float
    confidence_overall: float
    swot_analysis: Dict[str, List[str]]
    risk_assessment: str
    market_data: Optional[Dict[str, Any]] = None
